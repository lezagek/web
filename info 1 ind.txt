Вариант 7
Предметная область
В библиотеке хранятся книги. Каждая книга относится к одному жанру, опубликована в одном издательстве, может иметь одного или несколько авторов. 
Также о книге известна дата ее публикации. Библиотека располагает некоторым количеством экземпляров каждой книги.

Каждый человек может стать читателем в библиотеке. Читатель может взять одну или несколько книг на некоторое время. 
При этом в библиотеке сохраняется информация о дате выдачи книги и дате ее возврата. Когда читатель берет книгу, количество доступных экземпляров уменьшается, 
когда возвращает - увеличивается.

Задание 1
Для каждой книги, название которой состоит из одного слова, указать информацию о ее наличии в библиотеке (столбец available_numbers). 
Если количество доступных книг меньше 3 - вывести "мало", если количество в интервале от 3 до 5 - вывести "достаточно", если больше 5 - вывести "много". 
Для каждой книги также указать ее жанр и количество книг в наличии. Столбцы назвать Название, Жанр, Количество, Наличие. 
Информацию отсортировать сначала по возрастанию количества книг, а потом по названию в обратном алфавитном порядке.

Задание 2
Для каждого жанра вывести общее количество экземпляров книг, которые есть в наличии (available_numbers) в библиотеке. Если экземпляров книг какого-то жанра нет - вывести «-». 
Столбцы назвать Жанр, Количество_экземпляров. Информацию отсортировать сначала по убыванию количества экземпляров, а потом по названию жанров в алфавитном порядке.

Задание 3
Вывести название книг и их авторов (если авторов несколько – то указать их через запятую), заказанных самыми активными читателями. 
Самыми активными считать читателей, которые взяли больше всех книг.

Задание 4
Создать таблицу rating с рейтингом читателей (таблицу создавать на основе запроса). Рейтинг определяется активностью и добросовестностью читателей. 
Для его вычисления за каждую взятую книгу начисляются баллы по следующему правилу:

- если между датой получения и сдачи книги прошло меньше 14 дней, то читателю начисляется 5 баллов;
- если книга была "на руках" от 14 дней до 30 дней (включительно), читателю начисляется 2 балла;
- если книга была "на руках" больше 30 дней, у читателя вычитается 2 балла;
- если книга взята читателем, но еще не сдана, читателю начисляется 1 балл.

Полученные баллы суммируются.
Для того, чтобы вычислить количество дней между двумя датами (дата_1 меньше или равна дата_2) используется формула:
разница = дата_2 - дата_1

Задание 5
Вывести самую популярную книгу каждого автора. Если некоторые авторы пишут некоторые книги совместно, то для каждой такой группы авторов тоже вывести самую популярную книгу. 
Для книг, написанных более чем одним автором, авторов объединить в одну строку в алфавитном порядке, через запятую. Популярность книги определить следующим образом:

- для каждого автора(ов) самой популярной считается книга, которую чаще всего брали читатели в библиотеке;
- если несколько книг одного автора(ов) имеют одинаковую популярность, то выбрать ту из них, которая относится к более популярному жанру 
(самым популярным считать жанр, книги которого чаще всего брали читатели);
- если и эта характеристика совпадет, то выбрать ту книгу, которая имеет большее количество экземпляров в наличии.

Столбцы назвать Автор(ы) и Название. Информацию отсортировать в алфавитном порядке сначала по автору, а затем по названию книги.

Примечание. Для решения задания № 5 использовать оконные функции.